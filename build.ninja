project_name = kaleidoscope

cc = g++
cflags = -O2
llvm_flags = -I/mnt/c/Users/kjale/Documents/Dev/linux-usr-local/include -fPIC -fvisibility-inlines-hidden -Wall -W -Wno-unused-parameter -Wwrite-strings -Wcast-qual -Wno-missing-field-initializers -pedantic -Wno-long-long -Wno-maybe-uninitialized -Wdelete-non-virtual-dtor -Wno-comment -Werror=date-time -std=c++11 -g -fno-exceptions -fno-rtti -D_GNU_SOURCE -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -L/mnt/c/Users/kjale/Documents/Dev/linux-usr-local/lib -lLLVMLTO -lLLVMPasses -lLLVMObjCARCOpts -lLLVMMIRParser -lLLVMSymbolize -lLLVMDebugInfoPDB -lLLVMDebugInfoDWARF -lLLVMCoverage -lLLVMTableGen -lLLVMOrcJIT -lLLVMXCoreDisassembler -lLLVMXCoreCodeGen -lLLVMXCoreDesc -lLLVMXCoreInfo -lLLVMXCoreAsmPrinter -lLLVMSystemZDisassembler -lLLVMSystemZCodeGen -lLLVMSystemZAsmParser -lLLVMSystemZDesc -lLLVMSystemZInfo -lLLVMSystemZAsmPrinter -lLLVMSparcDisassembler -lLLVMSparcCodeGen -lLLVMSparcAsmParser -lLLVMSparcDesc -lLLVMSparcInfo -lLLVMSparcAsmPrinter -lLLVMRISCVDesc -lLLVMRISCVCodeGen -lLLVMRISCVInfo -lLLVMPowerPCDisassembler -lLLVMPowerPCCodeGen -lLLVMPowerPCAsmParser -lLLVMPowerPCDesc -lLLVMPowerPCInfo -lLLVMPowerPCAsmPrinter -lLLVMNVPTXCodeGen -lLLVMNVPTXDesc -lLLVMNVPTXInfo -lLLVMNVPTXAsmPrinter -lLLVMMSP430CodeGen -lLLVMMSP430Desc -lLLVMMSP430Info -lLLVMMSP430AsmPrinter -lLLVMMipsDisassembler -lLLVMMipsCodeGen -lLLVMMipsAsmParser -lLLVMMipsDesc -lLLVMMipsInfo -lLLVMMipsAsmPrinter -lLLVMLanaiDisassembler -lLLVMLanaiCodeGen -lLLVMLanaiAsmParser -lLLVMLanaiDesc -lLLVMLanaiInstPrinter -lLLVMLanaiInfo -lLLVMHexagonDisassembler -lLLVMHexagonCodeGen -lLLVMHexagonAsmParser -lLLVMHexagonDesc -lLLVMHexagonInfo -lLLVMBPFDisassembler -lLLVMBPFCodeGen -lLLVMBPFDesc -lLLVMBPFInfo -lLLVMBPFAsmPrinter -lLLVMARMDisassembler -lLLVMARMCodeGen -lLLVMARMAsmParser -lLLVMARMDesc -lLLVMARMInfo -lLLVMARMAsmPrinter -lLLVMAMDGPUDisassembler -lLLVMAMDGPUCodeGen -lLLVMAMDGPUAsmParser -lLLVMAMDGPUDesc -lLLVMAMDGPUInfo -lLLVMAMDGPUAsmPrinter -lLLVMAMDGPUUtils -lLLVMAArch64Disassembler -lLLVMAArch64CodeGen -lLLVMAArch64AsmParser -lLLVMAArch64Desc -lLLVMAArch64Info -lLLVMAArch64AsmPrinter -lLLVMAArch64Utils -lLLVMObjectYAML -lLLVMLibDriver -lLLVMOption -lLLVMX86Disassembler -lLLVMX86AsmParser -lLLVMX86CodeGen -lLLVMGlobalISel -lLLVMSelectionDAG -lLLVMAsmPrinter -lLLVMDebugInfoCodeView -lLLVMDebugInfoMSF -lLLVMX86Desc -lLLVMMCDisassembler -lLLVMX86Info -lLLVMX86AsmPrinter -lLLVMX86Utils -lLLVMMCJIT -lLLVMLineEditor -lLLVMInterpreter -lLLVMExecutionEngine -lLLVMRuntimeDyld -lLLVMCodeGen -lLLVMTarget -lLLVMCoroutines -lLLVMipo -lLLVMInstrumentation -lLLVMVectorize -lLLVMScalarOpts -lLLVMLinker -lLLVMIRReader -lLLVMAsmParser -lLLVMInstCombine -lLLVMTransformUtils -lLLVMBitWriter -lLLVMAnalysis -lLLVMObject -lLLVMMCParser -lLLVMMC -lLLVMBitReader -lLLVMProfileData -lLLVMCore -lLLVMSupport -lLLVMDemangle -lrt -ldl -ltinfo -lpthread -lm

cwinflags = /O2 /MDd /W3
llvm_win_flags = -IC:\Users\kjale\Documents\Dev\usr-local\include /DWIN32 /D_WINDOWS /W4 -wd4141 -wd4146 -wd4180 -wd4244 -wd4258 -wd4267 -wd4291 -wd4345 -wd4351 -wd4355 -wd4456 -wd4457 -wd4458 -wd4459 -wd4503 -wd4624 -wd4722 -wd4800 -wd4100 -wd4127 -wd4512 -wd4505 -wd4610 -wd4510 -wd4702 -wd4245 -wd4706 -wd4310 -wd4701 -wd4703 -wd4389 -wd4611 -wd4805 -wd4204 -wd4577 -wd4091 -wd4592 -wd4319 -wd4324 -w14062 -we4238 /Zc:inline /Zc:strictStrings /Oi /Zc:rvalueCast /EHs-c- /GR- /MP -D_CRT_SECURE_NO_DEPRECATE -D_CRT_SECURE_NO_WARNINGS -D_CRT_NONSTDC_NO_DEPRECATE -D_CRT_NONSTDC_NO_WARNINGS -D_SCL_SECURE_NO_DEPRECATE -D_SCL_SECURE_NO_WARNINGS -DUNICODE -D_UNICODE -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -LIBPATH:C:\Users\kjale\Documents\Dev\usr-local\lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMObjectYAML.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMMCJIT.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMMIRParser.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMOrcJIT.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMSymbolize.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMDebugInfoPDB.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMDebugInfoDWARF.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMInterpreter.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMExecutionEngine.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMRuntimeDyld.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMTableGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMLineEditor.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMLibDriver.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMOption.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMCoroutines.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMCoverage.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMXCoreDisassembler.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMXCoreCodeGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMXCoreDesc.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMXCoreInfo.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMXCoreAsmPrinter.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMX86Disassembler.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMX86AsmParser.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMX86CodeGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMX86Desc.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMX86Info.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMX86AsmPrinter.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMX86Utils.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMSystemZDisassembler.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMSystemZCodeGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMSystemZAsmParser.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMSystemZDesc.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMSystemZInfo.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMSystemZAsmPrinter.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMSparcDisassembler.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMSparcCodeGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMSparcAsmParser.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMSparcDesc.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMSparcInfo.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMSparcAsmPrinter.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMRISCVDesc.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMRISCVCodeGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMRISCVInfo.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMPowerPCDisassembler.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMPowerPCCodeGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMPowerPCAsmParser.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMPowerPCDesc.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMPowerPCInfo.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMPowerPCAsmPrinter.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMNVPTXCodeGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMNVPTXDesc.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMNVPTXInfo.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMNVPTXAsmPrinter.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMMSP430CodeGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMMSP430Desc.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMMSP430Info.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMMSP430AsmPrinter.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMMipsDisassembler.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMMipsCodeGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMMipsAsmParser.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMMipsDesc.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMMipsInfo.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMMipsAsmPrinter.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMLanaiDisassembler.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMLanaiCodeGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMLanaiAsmParser.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMLanaiDesc.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMLanaiInstPrinter.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMLanaiInfo.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMHexagonDisassembler.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMHexagonCodeGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMHexagonAsmParser.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMHexagonDesc.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMHexagonInfo.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMBPFDisassembler.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMBPFCodeGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMBPFDesc.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMBPFInfo.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMBPFAsmPrinter.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMARMDisassembler.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMARMCodeGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMARMAsmParser.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMARMDesc.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMARMInfo.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMARMAsmPrinter.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAMDGPUDisassembler.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAMDGPUCodeGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAMDGPUAsmParser.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAMDGPUDesc.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAMDGPUInfo.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAMDGPUAsmPrinter.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAMDGPUUtils.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAArch64Disassembler.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMMCDisassembler.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAArch64CodeGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMGlobalISel.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMSelectionDAG.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAsmPrinter.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMDebugInfoCodeView.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMDebugInfoMSF.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAArch64AsmParser.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAArch64Desc.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAArch64Info.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAArch64AsmPrinter.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAArch64Utils.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMLTO.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMPasses.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMObjCARCOpts.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMipo.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMInstrumentation.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMVectorize.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMLinker.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMIRReader.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAsmParser.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMCodeGen.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMTarget.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMScalarOpts.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMInstCombine.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMTransformUtils.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMBitWriter.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMAnalysis.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMObject.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMMCParser.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMMC.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMBitReader.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMProfileData.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMCore.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMSupport.lib C:\Users\kjale\Documents\Dev\usr-local\lib\LLVMDemangle.lib psapi.lib shell32.lib ole32.lib uuid.lib

rule cc
  command = $cc $cflags $in $llvm_flags -o $out

rule msvc
  command = cl.exe $cwinflags $llvm_win_flags /Fe: $out $in

rule check_build
  command = $cc $cflags $in $llvm_flags -c -fsyntax-only

build $project_name: cc ast.cpp jit.cpp driver.cpp log.cpp parser.cpp

build $project_name.exe: msvc ast.cpp jit.cpp driver.cpp log.cpp parser.cpp

build check: check_build ast.cpp jit.cpp driver.cpp log.cpp parser.cpp

default $project_name
